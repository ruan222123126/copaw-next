# Security Policy

## 漏洞提交流程

请不要在公开 issue 直接披露安全漏洞。

- 邮件：`security@copaw.local`（如暂未启用，请通过仓库维护者私信）
- 标题建议：`[copaw-next][security] <summary>`
- 建议包含：影响范围、复现步骤、风险等级、修复建议

收到报告后，目标响应时效：

- 24 小时内确认收到
- 72 小时内给出初步评估
- 7 天内给出修复计划或缓解方案

## 密钥管理策略

- 严禁在业务代码、测试快照、文档示例中硬编码密钥。
- 密钥仅可来自环境变量或 Secret Store。
- 推荐环境变量：
  - `COPAW_LIVE_OPENAI_API_KEY`
  - `OPENAI_API_KEY`
- 提交前应执行 secret scanning，并检查 `git diff` 中是否包含敏感值。

## 最小权限与默认关闭

- 危险能力默认关闭，按需开启。
- CI 令牌与运行权限应使用最小权限原则。
- 工作区上传必须做路径穿越校验（项目已启用）。

## AI 文件访问安全边界（本地开发）

- 允许相对路径与绝对路径访问；禁止通过 `..` 进行路径穿越。
- 建议允许访问根目录：`/mnt/Files`、`/home/ruan`（可按本地环境调整）。
- 以下系统目录应设为强制黑名单并禁止读写：
  - `/bin`
  - `/sbin`
  - `/usr`
  - `/lib`
  - `/lib64`
  - `/etc`
  - `/proc`
  - `/sys`
  - `/dev`
  - `/boot`
  - `/run`
  - `/var/run`
- 对符号链接应先解析 realpath，再按黑名单判定；命中黑名单时必须拒绝。

## 安全修复发布

- 安全修复优先走 `hotfix/*` 分支。
- 必须附带回归测试。
- 发布后补充 changelog 与影响范围说明。
